# Deep Action Proposals
Action Proposals generated by deep models

## GIT Tips

Every time that you work in something new, create a branch from master (or the
branch that you are interested).

`git checkout -b new-awesome-feat`

Once you have done your work i.e. a pair of commits, it's time to put these
changes on your parent branch.

1. `git checkout master` or more general `git checkout parent-branch`

2. `git merge new-awesome-feat`

> Note: the second step does the job. Don't skip it.

In order to keep the history of our `master` branch clean. We decide that
we will rebase our working branch e.g. `new-awesome-feat`.

`git rebase master` OR `git rebase master new-awesome-feat`

The later is just a shortcut for doing the former. Behind scenes is doing
`git checkout new-awesome-feat` followed by `git rebase master`.

Extra info: [git merge](https://git-scm.com/docs/git-merge), [git rebase](https://git-scm.com/docs/git-rebase)

## Data-Flow Recipes

### C3D features extraction

0. Compile C3D code. Recommended optional:symlink root-folder in `3rdparty/`.

1. Dump frames of the video.

> Why? we choose raw-images over raw-videos because weird behaviors happened using the video interface. Maybe, your opencv-ffmpeg version is not appropiate.

2. Create a CSV for `c3d_input_file_generator`.

3. Generate input.c3d and output.c3d with `c3d_input_file_generator(csv_from_step2)`.

4. Check that CSV generate in the step before point to a correct path.

> Tip: If you need to modify them, you may want to do it in [bash](##Useful-bash-commands).

5. Use our python program `python/tools/c3d_feat_frm.py` to extract c3d features. For example:

```
python/tools/c3d_feat_frm.py data/models/conv3d_deepnetA_sport1m_iter_1900000.caffemodel output.c3d fc7-1 -c '{"seq_source": "input.c3d", "mean_file": "data/models/sport1m_train16_128_mean.binaryproto", "batch_size": 50, "use_image": "true"}' -v
```

## Useful bash commands

### [Add prefix string to beginning of each line](http://stackoverflow.com/questions/2099471/add-a-prefix-string-to-beginning-of-each-line)

Create new file:

`sed -e 's/^/prefix/' file > file.new`

Edit file in-place:

`sed -i -e 's/^/prefix/' file`

### [Delete first character of each line](http://stackoverflow.com/questions/3795512/delete-the-first-5-chars-on-any-line-of-a-textfile-in-linux-with-sed?lq=1)

Replace 5 by the number of characters to delete

`sed 's/^.\{5\}//' file.dat`

### [Editing CSV with awk](http://www.ibm.com/developerworks/library/l-awk1/)

Extra help for awk commands:

- [Find and replace](http://www.cyberciti.biz/faq/awk-find-and-replace-fields-values/)

#### Append string at the end of the first column

Create new file:

`awk '{ gsub($1, $1"/", $1); print $0}' file >> file.new`

Edit file in-place:

`awk '{ gsub($1, $1"/", $1); print $0}' file >> tmp.new && mv tmp.new file`
